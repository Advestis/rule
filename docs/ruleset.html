<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.2" />
<title>ruleskit.ruleset API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>ruleskit.ruleset</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">from abc import ABC
import operator
from typing import List, Union
from functools import reduce
from collections import Counter
import numpy as np
from collections import OrderedDict
from .rule import Rule
from .condition import HyperrectangleCondition


class RuleSet(ABC):

    NLINES = 5

    def __init__(self, rules_list: Union[List[Rule], None] = None):
        if rules_list is None:
            self._rules = []
        else:
            self._rules = rules_list

    def __add__(self, other: Union[&#39;RuleSet&#39;, Rule]):
        if isinstance(other,  Rule):
            rules = self.rules + [other]
        else:
            rules = list(set(self.rules + other.rules))
        return RuleSet(rules)

    def __len__(self):
        return len(self.rules)

    def __eq__(self, other: &#34;RuleSet&#34;):
        return set(self.rules) == set(other.rules)

    def __iter__(self):
        return self.rules.__iter__()

    def __getitem__(self, x):
        return self.rules.__getitem__(x)

    def __str__(self):
        if len(self) &lt; 2 * RuleSet.NLINES:
            return &#34;\n&#34;.join([str(self[i]) for i in range(len(self))])
        else:
            return &#34;\n&#34;.join(
                [str(self[i]) for i in range(RuleSet.NLINES)]
                + [&#34;...&#34;]
                + [str(self[i]) for i in range(len(self) - RuleSet.NLINES, len(self))]
            )

    def sort(self) -&gt; None:
        if len(self) == 0:
            return
        if not (hasattr(self[0].condition, &#34;features_names&#34;) and hasattr(self[0].condition, &#34;bmins&#34;) and hasattr(
                self[0].condition, &#34;bmaxs&#34;)):
            return
        rules_by_fnames = OrderedDict()
        for rule in self:
            # noinspection PyUnresolvedReferences
            v = str(rule.condition.features_names)
            if v not in rules_by_fnames:
                rules_by_fnames[v] = [rule]
            else:
                rules_by_fnames[v].append(rule)
        rules_by_fnames = {n: sorted(rules_by_fnames[n], key=lambda x: x.condition.bmins + x.condition.bmaxs) for n in
                           rules_by_fnames}
        self._rules = []
        for n in rules_by_fnames:
            self._rules += rules_by_fnames[n]

    @property
    def rules(self) -&gt; List[Rule]:
        return self._rules

    def get_activation(self, xs: np.ndarray = None):
        if len(self) == 0:
            raise ValueError(&#34;The rule set is empty!&#34;)
        elif len(self) == 1:
            rule = self[0]
            if xs is None:
                # noinspection PyProtectedMember
                rs_activation = rule._activation
            else:
                rs_activation = rule.condition.evaluate(xs)
        else:
            if xs is not None:
                [rule.calc_activation(xs) for rule in self.rules]

            # noinspection PyProtectedMember
            rs_activation = [rule._activation for rule in self.rules]
            if len(rs_activation) &gt; 1:
                rs_activation = reduce(operator.add, rs_activation)

        return rs_activation

    def calc_coverage_rate(self, xs: np.ndarray = None):
        if len(self) == 0:
            return 0.0
        else:
            rs_activation = self.get_activation(xs)
            return rs_activation.coverage

    def get_variables_count(self):
        &#34;&#34;&#34;
        Get a counter of all different features in the ruleset
        Parameters
        ----------
        Return
        ------
        count : {Counter type}
            Counter of all different features in the ruleset
        &#34;&#34;&#34;
        # noinspection PyUnresolvedReferences
        var_in = [
            rule.condition.features_names
            if isinstance(rule.condition, HyperrectangleCondition)
            else rule.condition.features_indexes
            for rule in self
        ]
        if len(var_in) &gt; 1:
            var_in = reduce(operator.add, var_in)
        count = Counter(var_in)

        count = count.most_common()
        return count</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="ruleskit.ruleset.RuleSet"><code class="flex name class">
<span>class <span class="ident">RuleSet</span></span>
<span>(</span><span>rules_list: Union[List[<a title="ruleskit.rule.Rule" href="rule.html#ruleskit.rule.Rule">Rule</a>], NoneType] = None)</span>
</code></dt>
<dd>
<div class="desc"><p>Helper class that provides a standard way to create an ABC using
inheritance.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class RuleSet(ABC):

    NLINES = 5

    def __init__(self, rules_list: Union[List[Rule], None] = None):
        if rules_list is None:
            self._rules = []
        else:
            self._rules = rules_list

    def __add__(self, other: Union[&#39;RuleSet&#39;, Rule]):
        if isinstance(other,  Rule):
            rules = self.rules + [other]
        else:
            rules = list(set(self.rules + other.rules))
        return RuleSet(rules)

    def __len__(self):
        return len(self.rules)

    def __eq__(self, other: &#34;RuleSet&#34;):
        return set(self.rules) == set(other.rules)

    def __iter__(self):
        return self.rules.__iter__()

    def __getitem__(self, x):
        return self.rules.__getitem__(x)

    def __str__(self):
        if len(self) &lt; 2 * RuleSet.NLINES:
            return &#34;\n&#34;.join([str(self[i]) for i in range(len(self))])
        else:
            return &#34;\n&#34;.join(
                [str(self[i]) for i in range(RuleSet.NLINES)]
                + [&#34;...&#34;]
                + [str(self[i]) for i in range(len(self) - RuleSet.NLINES, len(self))]
            )

    def sort(self) -&gt; None:
        if len(self) == 0:
            return
        if not (hasattr(self[0].condition, &#34;features_names&#34;) and hasattr(self[0].condition, &#34;bmins&#34;) and hasattr(
                self[0].condition, &#34;bmaxs&#34;)):
            return
        rules_by_fnames = OrderedDict()
        for rule in self:
            # noinspection PyUnresolvedReferences
            v = str(rule.condition.features_names)
            if v not in rules_by_fnames:
                rules_by_fnames[v] = [rule]
            else:
                rules_by_fnames[v].append(rule)
        rules_by_fnames = {n: sorted(rules_by_fnames[n], key=lambda x: x.condition.bmins + x.condition.bmaxs) for n in
                           rules_by_fnames}
        self._rules = []
        for n in rules_by_fnames:
            self._rules += rules_by_fnames[n]

    @property
    def rules(self) -&gt; List[Rule]:
        return self._rules

    def get_activation(self, xs: np.ndarray = None):
        if len(self) == 0:
            raise ValueError(&#34;The rule set is empty!&#34;)
        elif len(self) == 1:
            rule = self[0]
            if xs is None:
                # noinspection PyProtectedMember
                rs_activation = rule._activation
            else:
                rs_activation = rule.condition.evaluate(xs)
        else:
            if xs is not None:
                [rule.calc_activation(xs) for rule in self.rules]

            # noinspection PyProtectedMember
            rs_activation = [rule._activation for rule in self.rules]
            if len(rs_activation) &gt; 1:
                rs_activation = reduce(operator.add, rs_activation)

        return rs_activation

    def calc_coverage_rate(self, xs: np.ndarray = None):
        if len(self) == 0:
            return 0.0
        else:
            rs_activation = self.get_activation(xs)
            return rs_activation.coverage

    def get_variables_count(self):
        &#34;&#34;&#34;
        Get a counter of all different features in the ruleset
        Parameters
        ----------
        Return
        ------
        count : {Counter type}
            Counter of all different features in the ruleset
        &#34;&#34;&#34;
        # noinspection PyUnresolvedReferences
        var_in = [
            rule.condition.features_names
            if isinstance(rule.condition, HyperrectangleCondition)
            else rule.condition.features_indexes
            for rule in self
        ]
        if len(var_in) &gt; 1:
            var_in = reduce(operator.add, var_in)
        count = Counter(var_in)

        count = count.most_common()
        return count</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>abc.ABC</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="ruleskit.ruleset.RuleSet.NLINES"><code class="name">var <span class="ident">NLINES</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="ruleskit.ruleset.RuleSet.rules"><code class="name">var <span class="ident">rules</span> : List[<a title="ruleskit.rule.Rule" href="rule.html#ruleskit.rule.Rule">Rule</a>]</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def rules(self) -&gt; List[Rule]:
    return self._rules</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="ruleskit.ruleset.RuleSet.calc_coverage_rate"><code class="name flex">
<span>def <span class="ident">calc_coverage_rate</span></span>(<span>self, xs: numpy.ndarray = None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def calc_coverage_rate(self, xs: np.ndarray = None):
    if len(self) == 0:
        return 0.0
    else:
        rs_activation = self.get_activation(xs)
        return rs_activation.coverage</code></pre>
</details>
</dd>
<dt id="ruleskit.ruleset.RuleSet.get_activation"><code class="name flex">
<span>def <span class="ident">get_activation</span></span>(<span>self, xs: numpy.ndarray = None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_activation(self, xs: np.ndarray = None):
    if len(self) == 0:
        raise ValueError(&#34;The rule set is empty!&#34;)
    elif len(self) == 1:
        rule = self[0]
        if xs is None:
            # noinspection PyProtectedMember
            rs_activation = rule._activation
        else:
            rs_activation = rule.condition.evaluate(xs)
    else:
        if xs is not None:
            [rule.calc_activation(xs) for rule in self.rules]

        # noinspection PyProtectedMember
        rs_activation = [rule._activation for rule in self.rules]
        if len(rs_activation) &gt; 1:
            rs_activation = reduce(operator.add, rs_activation)

    return rs_activation</code></pre>
</details>
</dd>
<dt id="ruleskit.ruleset.RuleSet.get_variables_count"><code class="name flex">
<span>def <span class="ident">get_variables_count</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Get a counter of all different features in the ruleset
Parameters</p>
<hr>
<h2 id="return">Return</h2>
<p>count : {Counter type}
Counter of all different features in the ruleset</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_variables_count(self):
    &#34;&#34;&#34;
    Get a counter of all different features in the ruleset
    Parameters
    ----------
    Return
    ------
    count : {Counter type}
        Counter of all different features in the ruleset
    &#34;&#34;&#34;
    # noinspection PyUnresolvedReferences
    var_in = [
        rule.condition.features_names
        if isinstance(rule.condition, HyperrectangleCondition)
        else rule.condition.features_indexes
        for rule in self
    ]
    if len(var_in) &gt; 1:
        var_in = reduce(operator.add, var_in)
    count = Counter(var_in)

    count = count.most_common()
    return count</code></pre>
</details>
</dd>
<dt id="ruleskit.ruleset.RuleSet.sort"><code class="name flex">
<span>def <span class="ident">sort</span></span>(<span>self) ‑> NoneType</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def sort(self) -&gt; None:
    if len(self) == 0:
        return
    if not (hasattr(self[0].condition, &#34;features_names&#34;) and hasattr(self[0].condition, &#34;bmins&#34;) and hasattr(
            self[0].condition, &#34;bmaxs&#34;)):
        return
    rules_by_fnames = OrderedDict()
    for rule in self:
        # noinspection PyUnresolvedReferences
        v = str(rule.condition.features_names)
        if v not in rules_by_fnames:
            rules_by_fnames[v] = [rule]
        else:
            rules_by_fnames[v].append(rule)
    rules_by_fnames = {n: sorted(rules_by_fnames[n], key=lambda x: x.condition.bmins + x.condition.bmaxs) for n in
                       rules_by_fnames}
    self._rules = []
    for n in rules_by_fnames:
        self._rules += rules_by_fnames[n]</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="ruleskit" href="index.html">ruleskit</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="ruleskit.ruleset.RuleSet" href="#ruleskit.ruleset.RuleSet">RuleSet</a></code></h4>
<ul class="two-column">
<li><code><a title="ruleskit.ruleset.RuleSet.NLINES" href="#ruleskit.ruleset.RuleSet.NLINES">NLINES</a></code></li>
<li><code><a title="ruleskit.ruleset.RuleSet.calc_coverage_rate" href="#ruleskit.ruleset.RuleSet.calc_coverage_rate">calc_coverage_rate</a></code></li>
<li><code><a title="ruleskit.ruleset.RuleSet.get_activation" href="#ruleskit.ruleset.RuleSet.get_activation">get_activation</a></code></li>
<li><code><a title="ruleskit.ruleset.RuleSet.get_variables_count" href="#ruleskit.ruleset.RuleSet.get_variables_count">get_variables_count</a></code></li>
<li><code><a title="ruleskit.ruleset.RuleSet.rules" href="#ruleskit.ruleset.RuleSet.rules">rules</a></code></li>
<li><code><a title="ruleskit.ruleset.RuleSet.sort" href="#ruleskit.ruleset.RuleSet.sort">sort</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.2</a>.</p>
</footer>
</body>
</html>